<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Samstag, Oktober 05, 2024, 3:52  -->
<!-- MuClient version 5.06 -->

<!-- Plugin "mystavaria" generated by Plugin Wizard -->

<muclient>
<plugin
   name="mystavaria"
   author="Atlan"
   id="5279d60de184ab1656e0d276"
   language="Lua"
   purpose="soundpack for mystavaria"
   date_written="2024-10-05 15:02:36"
   requires="5.06"
   version="1.0"
   >

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>
<!--  Script  -->


<script>
<![CDATA[
require("mystavaria.main")

Path = require("pl.path")

require("mystavaria.util")


-- =============================
-- Mystavaria Ambience System
-- =============================

-- Tabelle mit den Ambience-Sounds
AmbienceSounds = {
  forest = "forest.ogg",
  city   = "city.ogg"
}

CurrentAmbienceID = nil
CurrentAmbienceArea = nil

-- Ambience setzen
function SetAmbience(area)
  local file = AmbienceSounds[area]
  if not file then
    Note("Keine Ambience definiert für Area: " .. tostring(area))
    return
  end

  -- wenn derselbe Bereich -> nichts tun
  if CurrentAmbienceArea == area then
    return
  end

  -- alten stoppen (falls vorhanden)
  if CurrentAmbienceID then
    StopSound(CurrentAmbienceID)
    CurrentAmbienceID = nil
  end

  -- neuen starten
  CurrentAmbienceID = PlayAmbienceSound(file)
  CurrentAmbienceArea = area
end

-- Ambience abspielen
function PlayAmbienceSound(file)
  if (ConfigTable.Settings.AmbienceSounds == 1) then
    if not Path.isabs(file) then
      file = SoundFolder .. "ambience/" .. file
    end
    CurrentAmbienceSound = Audio.play(file, 1, 0, ConfigTable.Settings.AmbienceVolume)
    return CurrentAmbienceSound
  end
end

-- Sound stoppen
function StopSound(id)
  if ((tonumber(id) ~= nil) and (Audio.isPlaying(id) == 1)) then
    return Audio.stop(id)
  end
end

-- === Globale Speicherzustände ===
if not HealthPanState then
 HealthPanState = {
  last_current = nil,
  last_max  = nil,
  last_play_ms = 0,
 }
end

if not StatusState then
 StatusState = {
  last_hp = nil,
  last_mana = nil,
 }
end

-- === Konfiguration ===
MIN_DELTA = 1
THROTTLE_MS = 0
PAN_CURVE = "linear"
ENEMY_SOUND = "misc/hp_enemy.ogg"
HP_CHANGE_SOUND = "misc/hp_change.ogg"
MANA_CHANGE_SOUND = "misc/mana.ogg"

-- === Hilfsfunktionen ===
local function now_ms()
 return (GetInfo and GetInfo(232)) or 0
end

local function clamp(v, lo, hi)
 if v < lo then return lo end
 if v > hi then return hi end
 return v
end

-- r in [0..1] -> pan in [-1..+1]
local function map_ratio_to_pan(r)
 r = clamp(r, 0, 1)
 if PAN_CURVE == "ease" then
  r = r * r * (3 - 2 * r)
 end
 return 2 * r - 1
end

-- === Gegner-HP Funktion ===
function OnHealthPan(name, line, wildcards)
 local enemy_name = wildcards[1]
 local current  = tonumber(wildcards[2])
 local maxhp   = tonumber(wildcards[3])

 if not current or not maxhp or maxhp <= 0 then return end

 local dropped = false
 if HealthPanState.last_current and HealthPanState.last_current < 0 and current > 0 then
  HealthPanState.last_current = nil
  HealthPanState.last_max  = nil
  dropped = true
 end

 local first_hit = (HealthPanState.last_current == nil)
 if first_hit then dropped = true end

 local r = clamp((current <= 0) and 0 or (current / maxhp), 0, 1)
 local pan = map_ratio_to_pan(r) * 100

 local prev = HealthPanState.last_current
 if prev == nil then prev = current end
 prev = clamp(prev, 0, maxhp)

 if not dropped then
  dropped = (current < prev) and ((prev - current) >= MIN_DELTA)
 end

 local tnow = now_ms()
 if dropped and (THROTTLE_MS == 0 or (tnow - HealthPanState.last_play_ms >= THROTTLE_MS)) then
  PlayGlobalSound(ENEMY_SOUND, pan)
  HealthPanState.last_play_ms = tnow
 end

 HealthPanState.last_current = current
 HealthPanState.last_max  = maxhp
end

-- === Player-Status-Update Funktion ===
function OnStatusUpdate(name, line, wildcards)
 local current_hp = tonumber(wildcards[1])
 local max_hp = tonumber(wildcards[2])
 local current_mana = tonumber(wildcards[3])
 local max_mana = tonumber(wildcards[4])

 if not current_hp or not current_mana then return end

 if StatusState.last_hp ~= nil and current_hp ~= StatusState.last_hp then
  local hp_ratio = current_hp / max_hp
  local pan_value = (hp_ratio * 200) - 100
  pan_value = math.max(-100, math.min(100, pan_value))
  PlayGlobalSound(HP_CHANGE_SOUND, pan_value)
 end

 if StatusState.last_mana ~= nil and current_mana ~= StatusState.last_mana then
  local mana_ratio = current_mana / max_mana
  local pan_value = (mana_ratio * 200) - 100
  pan_value = math.max(-100, math.min(100, pan_value))
  PlayGlobalSound(MANA_CHANGE_SOUND, pan_value)
 end

 StatusState.last_hp = current_hp
 StatusState.last_mana = current_mana
end
]]>
</script>

  <triggers>

<!-- Channel -->
<trigger
  enabled="y"
  group="channel"
  match="*[Newbie]*"
  send_to="12"
  sequence="100"
  >
    <send>
    CurrentGlobalSound = PlayGlobalSound("channels/newbie.ogg")
    Execute("history_add newbie=%0")
Execute("history_add all=%0")
  </send>
</trigger>
<trigger
  enabled="y"
  group="channel"
  match="*[Public]*"
  send_to="12"
  sequence="100"
  >
    <send>
      CurrentGlobalSound = PlayGlobalSound("channels/public.ogg")
      Execute("history_add public=%0")
Execute("history_add all=%0")
      </send>
</trigger>
<trigger
  enabled="y"
  group="channel"
  match="*[OOC]*"
  send_to="12"
  sequence="100"
  >
    <send>
      CurrentGlobalSound = PlayGlobalSound("channels/ooc.ogg")
      Execute("history_add ooctell=%0")
Execute("history_add all=%0")
  </send>
</trigger>
<trigger
      enabled="y"
      group="channel"
      match="*voice ripples in the depths of your subconscious,*"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("channels/tell.ogg")
Execute("history_add tell=%0")
Execute("history_add all=%0")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="channel"
      match="You whisper a thought to * subconscious,*"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("channels/tell.ogg")
Execute("history_add tell=%0")
Execute("history_add all=%0")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="channel"
      match="You say,*"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("channels/say.ogg")
Execute("history_add say=%0")
Execute("history_add all=%0")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="channel"
      match="* exclaims,*"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("channels/say.ogg")
Execute("history_add say=%0")
Execute("history_add all=%0")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="channel"
      match="^(.+?)\s+says,\s+(.+)$"
      send_to="12"
      sequence="100"
regexp="y"
>
      <send>
CurrentGlobalSound = PlayGlobalSound("channels/say.ogg")
Execute("history_add say=%1 says, %2")
Execute("history_add all=%1 says, %2")
      </send>
    </trigger>
<trigger
    enabled="y"
    group="channel"
    match="* has sent you a message *"
    send_to="12"
    sequence="100"
>
    <send>
CurrentGlobalSound = PlayGlobalSound("channels/tell.ogg")
Execute("history_add Messages=%0")
Execute("history_add all=%0")
    </send>
</trigger>
<trigger
      enabled="y"
      group="channel"
      match="You send a message to *"
      send_to="12"
      sequence="100"
>
      <send>
CurrentGlobalSound = PlayGlobalSound("channels/tell.ogg")
Execute("history_add Messages=%0")
Execute("history_add all=%0")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="You recieve * lessons for your daily activity!"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("channels/day.ogg")
Execute("history_add day=%0")
Execute("history_add all=%0")
      </send>
    </trigger>

<!-- Channel end -->

<!-- misc -->

<trigger
      enabled="y"
      group="misc"
      match="You have gained a new level!"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/level.ogg")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="Twines of luminous blue and purple swirl about you as your essence is gathered and absorbed into the form of *"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/login.ogg")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="An ethereal mist billows from the ground, swirling around you in luminous blue and purple twines. In the blink of an eye, the mist consumes you and you vanish into the ether."
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/logout.ogg")
      </send>
    </trigger>
<trigger
  enabled="y"
  group="misc"
  match="You are no longer wearing *"
  send_to="12"
  sequence="100"
  >
  <send>
    CurrentGlobalSound = PlayGlobalSound("misc/remove.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="misc"
  match="You are now wearing *"
  send_to="12"
  sequence="100"
  >
  <send>
    CurrentGlobalSound = PlayGlobalSound("misc/wear.ogg")
  </send>
</trigger>
<trigger
      enabled="y"
      group="misc"
      match="You withdraw * coins from the bank *"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/gold_withdraw.ogg")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="You deposit * coins into the bank *"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/gold_deposit.ogg")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="You drop a handful of * coins."
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/dropgold.ogg")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="You get a handful of * coins."
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/get_gold.ogg")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="You have completed an accolade!"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/accolade.ogg")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="You gain * experience*"
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/xp.ogg")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="You have regained equilibrium."
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/equilibrium.ogg")
      </send>
    </trigger>
<trigger
      enabled="y"
      group="misc"
      match="You have regained balance."
      send_to="12"
      sequence="100"
    >
      <send>
CurrentGlobalSound = PlayGlobalSound("misc/balance.ogg")
      </send>
    </trigger>
<!-- misc end -->
<!-- herbology -->

<trigger
  enabled="y"
  group="herbs"
  match="You pick * from a *"
  send_to="12"
  sequence="100"
  >
  <send>
    CurrentGlobalSound = PlayGlobalSound("herbs/collect.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="herbs"
  match="You prepare * for use."
  send_to="12"
  sequence="100"
  >
  <send>
    CurrentGlobalSound = PlayGlobalSound("herbs/prepare.ogg")
  </send>
</trigger>
<!-- weapons -->

<trigger
  enabled="y"
  group="weapons"
  match="You are now wielding * shortsword in your *"
  send_to="12"
  sequence="100"
  >
  <send>
CurrentGlobalSound = PlayGlobalSound("weapons/shortsword"..(math.random(1, 5))..".ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="weapons"
  match="You are no longer wielding * shortsword in your *"
  send_to="12"
  sequence="100"
  >
  <send>
CurrentGlobalSound = PlayGlobalSound("weapons/sheathsword"..(math.random(1, 5))..".ogg")
  </send>
</trigger>

<!-- backpacks -->

<trigger
  enabled="y"
  group="backpacks"
  match="You open * backpack*"
  send_to="12"
  sequence="100"
  >
  <send>
CurrentGlobalSound = PlayGlobalSound("backpacks/open"..(math.random(1, 5))..".ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="backpacks"
  match="You close * backpack*"
  send_to="12"
  sequence="100"
  >
  <send>
CurrentGlobalSound = PlayGlobalSound("backpacks/close.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="backpacks"
  match="You remove * from * backpack*"
  send_to="12"
  sequence="100"
  >
  <send>
CurrentGlobalSound = PlayGlobalSound("backpacks/get.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="backpacks"
  match="You put * in * backpack*"
  send_to="12"
  sequence="100"
  >
  <send>
CurrentGlobalSound = PlayGlobalSound("backpacks/put"..(math.random(1, 3))..".ogg")
  </send>
</trigger>
<!-- backpacks end -->
<!-- Alchemy -->
<trigger
  enabled="y"
  group="alchemy"
  match="You prepare to mix * in *"
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/prepare_bottle.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="Whispering a quiet incantation, you fill * with a potent, ethereal substance which shimmers and swirls around visibly inside the *"
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/fill.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="You carefully measure out a dose of * then crush and sprinkle it into the mixture, watching as it spirals around."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/herbs.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="Strange patterns form on the surface of the potion, shifting and morphing in a mesmerising display."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/bubble3.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="The mixture boils over suddenly, spilling out of a * and scorching the surrounding area."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/boil.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="A faint, energising scent fills the air and you feel a tingling sensation like a surge of electricity along your skin, as if the atmosphere is charged with the essence of a brewing storm."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/electric.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="A gentle mist rises from the * and cascades over the edges of * feeling cool and refreshing as it licks your skin."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/mist.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="As the mist clears, you observe your alchemical creation with satisfaction, the * now complete."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/finish"..(math.random(1, 4))..".ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="The potion bubbles and froths violently, releasing a pleasant aroma as it churns within *"
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/cauldron.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="The potion roils and churns within * releasing a putrid, nauseating aroma that permeates the air, causing your eyes to water and your stomach to churn in revulsion."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/bubble2.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="A series of unsettling crackling sounds emanating from the mixture startles you before it suddenly settles into an ominous, foreboding stillness."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/crack.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="The potion emits a series of loud, ominous cracks, as if the glass itself is under immense pressure."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/crack.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="An eerie, black fog rises from the potion, engulfing the edges of a * in darkness and sending an icy shiver down your spine as it caresses your skin, compelling you to quickly waft it away with your hand."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/mist.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="As the mist dissipates, you stare at your concoction with a mixture of curiosity and apprehension, realising its colour is far from intended and that you have no way to be certain of its effects save for personal experimentation."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/finish.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="You sip a *"
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/sip.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="The mixture bubbles and froths in response."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/bubble4.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="Wisps of colourful green mist rise from the potion, swirling and dancing in a vibrant alchemical display."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/mist.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="With a sudden hiss, the mixture stills, abruptly settling into a vibrant * hue that shimmers and radiates a subtle glow."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/hiss.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="An eerie, * fog rises from the potion, engulfing the edges of an empty * in darkness and sending an icy shiver down your spine as it caresses your skin, compelling you to quickly waft it away with your hand."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/mist.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="Acrid fumes billow from * causing you to gag and choke as the potion turns volatile."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/choke.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="Vibrations course through an empty *"
  send_to="12"
  sequence="100"
  omit_from_output="n"
  omit_from_log="n"
>
<send>
<![CDATA[
  PlayGlobalSound("alchemy/electric.ogg")
  for i = 1, 10 do
    DoAfterSpecial(i * 0.2, 'PlayGlobalSound("alchemy/vibrate.ogg")', sendto.script)
  end
]]>
</send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="A violent explosion causes the potion mixture to erupt, splattering its contents everywhere."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/explosion.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="With a sudden hiss, the mixture stills, abruptly settling into a vibrant red hue that shimmers and radiates a subtle glow."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/hiss.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="As the ingredients blend, a faint red mist envelops the potion, swirling and undulating like ethereal tendrils."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/mist.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="The potion emits a soft red glow as the ingredients interact, casting eerie shadows around you."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/shadows.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="Trembling violently, an empty * threatens to shatter as the potion's reaction grows increasingly unstable."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/crack.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="Tiny sparks crackle and pop upon the surface of the mixture, briefly illuminating your surroundings with flashes of blue light."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/electric.ogg")
  </send>
</trigger>
<trigger
  enabled="y"
  group="alchemy"
  match="Waves of energy ripple through * casting prismatic reflections in a kaleidoscope of shifting hues."
  send_to="12"
  sequence="100"
  omit_from_output="y"
  omit_from_log="y"
>
  <send>
CurrentGlobalSound = PlayGlobalSound("alchemy/electric.ogg")
  </send>
</trigger>

<!-- alchemy end -->
<!-- healthbar -->

<trigger
 enabled="y"
 match="\[(.+)'s health after .*: (\-?\d+)/(\d+)\]"
 regexp="y"
 send_to="12"
 sequence="100"
omit_from_output="y"
omit_from_log="y"
 script="OnHealthPan"
/>
<trigger
 enabled="y"
 match="(\d+)/(\d+)h, (\d+)/(\d+)m.+"
 regexp="y"
 send_to="12"
 sequence="100"
omit_from_output="y"
omit_from_log="y"
 script="OnStatusUpdate"
/>
<!-- healthbar end -->

<!-- ambience -->

<trigger
  enabled="y"
  group="ambience"
  match="^(Climbing the Branches of the Tree|Treetop of Arborvella|Lower Platform of Arborvella|Northwest Side of the Lower Village Platform|North Side of the Lower Village Platform|Northeast Side of the Lower Village Platform|East Side of the Lower Village Platform|Southeast Side of the Lower Village Platform|Lower Platform Outside the House of Wellbeing|Southwest Side of the Lower Village Platform|Middle Platform of Arborvella|Southwest Side of the Middle Village Platform|Southeast Side of the Middle Village Platform|East Side of the Middle Village Platform|East of a Living Root Bridge|The Living Root Bridge of Arborvella|West of a Living Root Bridge|West Side of the Middle Village Platform|Stairs up the Tree|Top Platform of Arborvella|Northeast Platform|Northern Platform Outside of the Realm Tavern|Northwest Platform by Arborvella Postal Halls|Western Platform Overlooking Thatched Roofs|Southwest Platform|Southern Platform|Southeast Platform|Stairs Around the Tree|Within the Branches|The Southern Branch of Reality|Along the Southern Branch|Southern Branch over the River of Life|Southern Branch over Privia|Privia Branch Landing|The Western Branch of Reality|Along the Western Branch|Western Branch over Elivakar|Western Branch near Invikta|Western Branch over Invikta|The Eastern Branch of Reality|Along the Eastern Branch|Eastern Branch over the River of Life|Eastern Branch near Sulastella|Eastern Branch over Sulastella|The Northern Branch of Reality|Along the Northern Branch|Northern Branch over the River of Life|Northern Branch near Laminae|Northern Branch over Laminae|Chamber of Portals)$"
    regexp="y"
  send_to="12"
  sequence="100"
>
  <send>
  SetAmbience("forest")
  </send>
</trigger>
<trigger
  enabled="y"
  group="ambience"
  match="^(West end of Crimson Lane|Crimson Lane West|The Nexus of Calamity|Crimson Lane East|Nexus of Crimson and Obsidian|The Crimson Tree|Crimson Lane by King's Market|East end of Crimson Lane|The King's Market|Before the Black Spire|The Rotunda of Glory|The Ebony Path|South Praestantia Square|Centre of Praestantia Square|West Praestantia square|East Praestantia square|North Praestantia square|Northwest praestantia square|Southwest Praestantia square|Southeast Praestantia square|Northeast Praestantia square)$"
  regexp="y"
    send_to="12"
  sequence="100"
>
  <send>SetAmbience("city")</send>
</trigger>

<!-- ambience end -->

</triggers>

</muclient>